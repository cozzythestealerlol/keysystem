local k_part_a = "%^DG&a"
local k_part_b = "etrs"
local k_part_c = "32wb"
local k_part_d = "ey4"

local correctKey = k_part_a .. k_part_b .. k_part_c .. k_part_d

local gameScripts = {
	[108631717812345] = "https://raw.githubusercontent.com/cozzythestealerlol/mainscript/refs/heads/main/hujsfjkhsfsailh",
	[118915549367482] = "https://raw.githubusercontent.com/cozzythestealerlol/dwtbguiandstuff/refs/heads/main/dwtbadminsass",
	[137308168315486] = "https://raw.githubusercontent.com/cozzythestealerlol/twb78kah/refs/heads/main/ohahopadsf",
	[18450282790] = "https://raw.githubusercontent.com/cozzythestealerlol/avtwvta/refs/heads/main/drby6rt"
}

local defaultScript = "nope"

local clipboardLink = "https://work.ink/28lh/key-system-brainrot"
-- KEEP HERE TILL READY: https://raw.githubusercontent.com/cozzytheidiot-star/6wrhtds6e4itwvatr/refs/heads/main/e4vtsde45ybe5

local CACHE_SECONDS = 48 * 60 * 60

local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local player = game.Players.LocalPlayer

local function fileApiAvailable()
	return (type(isfile) == "function") and (type(readfile) == "function") and (type(writefile) == "function")
end

local function cacheFileName()
	return "keysystem_" .. tostring(player.UserId) .. ".json"
end

local function readCache()
	if not fileApiAvailable() then return nil end
	local fname = cacheFileName()
	local ok, contents = pcall(function() return readfile(fname) end)
	if not ok or not contents or contents == "" then return nil end
	local success, data = pcall(function() return HttpService:JSONDecode(contents) end)
	if not success or type(data) ~= "table" then
		pcall(function() delfile(fname) end)
		return nil
	end
	return data
end

local function writeCache(storedKey, expiry)
	if not fileApiAvailable() then return end
	local fname = cacheFileName()
	local data = { key = storedKey, expiry = expiry }
	local ok, encoded = pcall(function() return HttpService:JSONEncode(data) end)
	if ok and encoded then pcall(function() writefile(fname, encoded) end) end
end

local function deleteCache()
	if not fileApiAvailable() then return end
	pcall(function() delfile(cacheFileName()) end)
end

local function runGameScriptAndCleanup(scriptURL, guiObj, blurObj)
	pcall(function()
		if scriptURL and scriptURL ~= "" then
			local success = pcall(function()
				local code = game:HttpGet(scriptURL)
				if code and #code > 0 then
					local fn = loadstring(code)
					if type(fn) == "function" then fn() end
				end
			end)
		end
	end)
	if guiObj and guiObj.Parent then pcall(function() guiObj:Destroy() end) end
	if blurObj and blurObj.Parent then pcall(function() blurObj:Destroy() end) end
end

do
	local cached = readCache()
	if cached and type(cached) == "table" then
		local storedKey = cached.key
		local expiry = tonumber(cached.expiry) or 0
		local now = os.time()

		if storedKey == correctKey and expiry > now then
			local scriptURL = gameScripts[game.PlaceId] or defaultScript
			pcall(function()
				local ok, code = pcall(function() return game:HttpGet(scriptURL) end)
				if ok and code and #code > 0 then
					local fn = loadstring(code)
					if type(fn) == "function" then fn() end
				end
			end)
			return
		else
			deleteCache()

			local playerGui = player:WaitForChild("PlayerGui")
			local notifGui = Instance.new("ScreenGui")
			notifGui.Name = "KeyExpiredNotice"
			notifGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
			notifGui.IgnoreGuiInset = true
			notifGui.Parent = playerGui

			local notifFrame = Instance.new("Frame")
			notifFrame.Size = UDim2.new(0, 400, 0, 70)
			notifFrame.Position = UDim2.new(0.5, 0, 1, -80)
			notifFrame.AnchorPoint = Vector2.new(0.5, 1)
			notifFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
			notifFrame.BackgroundTransparency = 0.25
			notifFrame.Parent = notifGui

			local notifCorner = Instance.new("UICorner", notifFrame)
			notifCorner.CornerRadius = UDim.new(0, 12)

			local icon = Instance.new("TextLabel", notifFrame)
			icon.Size = UDim2.new(0, 50, 1, 0)
			icon.BackgroundTransparency = 1
			icon.TextColor3 = Color3.fromRGB(255, 220, 50)
			icon.Font = Enum.Font.GothamBold
			icon.TextScaled = true
			icon.Text = "âš "

			local notifLabel = Instance.new("TextLabel", notifFrame)
			notifLabel.Size = UDim2.new(1, -60, 1, 0)
			notifLabel.Position = UDim2.new(0, 60, 0, 0)
			notifLabel.BackgroundTransparency = 1
			notifLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
			notifLabel.Font = Enum.Font.GothamBold
			notifLabel.TextScaled = true
			notifLabel.TextWrapped = true
			notifLabel.Text = "Your saved key expired or changed.\nPlease re-enter it."

			local sound = Instance.new("Sound", notifFrame)
			sound.SoundId = "rbxassetid://3165700530"
			sound.Volume = 1
			sound:Play()
			task.delay(sound.TimeLength, function()
				sound:Play()
			end)

			local fadeIn = TweenService:Create(notifFrame, TweenInfo.new(0.4), {BackgroundTransparency = 0.15})
			fadeIn:Play()
			task.wait(4)
			local fadeOut = TweenService:Create(notifFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1})
			fadeOut:Play()
			task.wait(0.6)
			notifGui:Destroy()
		end
	end
end

local gui = Instance.new("ScreenGui")
gui.Name = "KeySystemGui"
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local blur = Instance.new("BlurEffect")
blur.Size = 0
blur.Parent = game.Lighting

local bgFrame = Instance.new("Frame")
bgFrame.Parent = gui
bgFrame.Size = UDim2.new(1, 0, 1, 0)
bgFrame.BackgroundTransparency = 1
local bgGradient = Instance.new("UIGradient", bgFrame)
bgGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 160, 130)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(100, 150, 255)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 220, 200))
}
bgGradient.Rotation = 45

local frame = Instance.new("Frame")
frame.Parent = gui
frame.Size = UDim2.new(0, 420, 0, 220)
frame.Position = UDim2.new(0.5, 0, 0.5, 0)
frame.AnchorPoint = Vector2.new(0.5, 0.5)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.BackgroundTransparency = 0.55
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 20)

local gradient = Instance.new("UIGradient", frame)
gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 180, 130)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(90, 140, 255))
}
gradient.Rotation = 45

local closeBtn = Instance.new("TextButton", frame)
closeBtn.Text = "X"
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -40, 0, 10)
closeBtn.BackgroundTransparency = 0.8
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 20
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1, 0)

local tooltip = Instance.new("TextLabel", closeBtn)
tooltip.Text = "Close"
tooltip.BackgroundTransparency = 1
tooltip.TextColor3 = Color3.fromRGB(255, 255, 255)
tooltip.TextSize = 12
tooltip.Position = UDim2.new(-0.3, 0, 1, 0)
tooltip.Visible = false

closeBtn.MouseEnter:Connect(function()
	closeBtn.BackgroundTransparency = 0.5
	tooltip.Visible = true
end)
closeBtn.MouseLeave:Connect(function()
	closeBtn.BackgroundTransparency = 0.8
	tooltip.Visible = false
end)
closeBtn.MouseButton1Click:Connect(function()
	gui:Destroy()
	blur:Destroy()
end)

local keyLabel = Instance.new("TextLabel", frame)
keyLabel.Text = "Key:"
keyLabel.Position = UDim2.new(0.1, 0, 0.35, 0)
keyLabel.Size = UDim2.new(0, 50, 0, 30)
keyLabel.BackgroundTransparency = 1
keyLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
keyLabel.Font = Enum.Font.Gotham
keyLabel.TextSize = 18

local keyBox = Instance.new("TextBox", frame)
keyBox.PlaceholderText = "Enter your key"
keyBox.Position = UDim2.new(0.25, 0, 0.35, 0)
keyBox.Size = UDim2.new(0.5, 0, 0, 30)
keyBox.BackgroundTransparency = 0.3
keyBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
keyBox.TextColor3 = Color3.fromRGB(0, 0, 0)
keyBox.PlaceholderColor3 = Color3.fromRGB(0, 0, 0)
keyBox.Font = Enum.Font.Gotham
keyBox.TextSize = 16
Instance.new("UICorner", keyBox).CornerRadius = UDim.new(0, 10)

local submitBtn = Instance.new("TextButton", frame)
submitBtn.Text = "Submit"
submitBtn.Size = UDim2.new(0, 140, 0, 35)
submitBtn.Position = UDim2.new(0.15, 0, 0.55, 0)
submitBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
submitBtn.BackgroundTransparency = 0.3
submitBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
submitBtn.Font = Enum.Font.GothamBold
submitBtn.TextSize = 18
Instance.new("UICorner", submitBtn).CornerRadius = UDim.new(0, 10)

local copyBtn = Instance.new("TextButton", frame)
copyBtn.Text = "Key System Here"
copyBtn.Size = UDim2.new(0, 140, 0, 35)
copyBtn.Position = UDim2.new(0.55, 0, 0.55, 0)
copyBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
copyBtn.BackgroundTransparency = 0.3
copyBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
copyBtn.Font = Enum.Font.GothamBold
copyBtn.TextSize = 16
Instance.new("UICorner", copyBtn).CornerRadius = UDim.new(0, 10)

copyBtn.MouseButton1Click:Connect(function()
	if setclipboard then
		setclipboard(clipboardLink)
		copyBtn.Text = "Copied!"
		task.wait(2)
		copyBtn.Text = "Key System Here"
	end
end)

frame.BackgroundTransparency = 1
blur.Size = 0
task.spawn(function()
	for i = 1, 20 do
		frame.BackgroundTransparency = 1 - (i * 0.02)
		blur.Size = i * 0.6
		task.wait(0.02)
	end
end)

local function resetKeyBox()
	keyBox.PlaceholderText = "Enter your key"
	keyBox.Text = ""
	submitBtn.Active = true
	keyBox.Active = true
end

local function successFlow()
	local expiry = os.time() + CACHE_SECONDS
	writeCache(correctKey, expiry)
	local tweenInfo = TweenInfo.new(0.6, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	TweenService:Create(frame, tweenInfo, {Size = UDim2.new(0, 250, 0, 120)}):Play()
	for _, obj in ipairs(frame:GetChildren()) do obj:Destroy() end
	local welcomeText = Instance.new("TextLabel", frame)
	welcomeText.Size = UDim2.new(1, 0, 1, 0)
	welcomeText.BackgroundTransparency = 1
	welcomeText.TextColor3 = Color3.fromRGB(255, 255, 255)
	welcomeText.Font = Enum.Font.GothamBold
	welcomeText.TextScaled = true
	welcomeText.Text = "Welcome, " .. player.Name .. "!"
	task.wait(1.25)
	for i = 1, 20 do
		local alpha = i / 20
		frame.BackgroundTransparency = 0.55 + (0.45 * alpha)
		welcomeText.TextTransparency = alpha
		blur.Size = math.max(0, blur.Size - 0.6)
		task.wait(0.03)
	end
	local scriptURL = gameScripts[game.PlaceId] or defaultScript
	runGameScriptAndCleanup(scriptURL, gui, blur)
end

submitBtn.MouseButton1Click:Connect(function()
	local entered = keyBox.Text
	if entered == correctKey then
		successFlow()
	else
		keyBox.PlaceholderText = "Wrong Key Was Entered, Try Again!"
		keyBox.Text = ""
		submitBtn.Active = false
		keyBox.Active = false
		task.delay(2, resetKeyBox)
	end
end)
